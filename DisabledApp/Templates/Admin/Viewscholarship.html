{% load static %}
{% include "Admin/Header.html" %}
<script src="{% static 'Admin/jquery-3.7.1.min.js' %}"></script>
<script>
    $(document).ready(function() {
        $.ajaxSetup({
            headers: { "X-CSRFToken": '{{csrf_token}}' }
        });
        $('#categoryid').change(function() {
            var categoryid = $(this).val();
            $.ajax({
                type: "POST",
                url: '{% url "fillscholarship" %}',
                data: { cid: categoryid},
                dataType: "json",
                success: function(data) {
                    $('#scholarship').empty();
                    s = 1;
                    $.each(data, function (key, val) {
                        var id=val.scholarshipid;
                        var editurl='{% url "editscholarship" 0 %}'.replace('0',id);
                        var deleteurl='{% url "deletescholarship" 0 %}'.replace('0',id);
                        var row = '<tr> <td>' + s++ +'</td>'+
                            '<td>' + val.scholarshipname + '</td>'+
                            '<td>' + val.scholarshipdesc + '</td>'+
                            '<td>' + val.criteria + '</td>'+
                            '<td>' + val.startdate + '</td>'+
                            '<td>' + val.enddate + '</td>'+
                            '<td><a href="' + val.link + '" target="_blank" class="btn btn-info btn-sm">View</a></td>'+
                            '<td><a href="' + editurl +'" class="btn btn-warning btn-sm me-2">Edit</a>'+
                            '<a href="' + deleteurl +'" onclick="return confirm(\'Are you sure you want to delete this scholarship?\')" class="btn btn-danger btn-sm">Delete</a></td>'+
                            '</tr>';
                        $('#scholarship').append(row);
                    });
                }
            });   
        });
    });
</script>
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow-lg border-0 rounded-lg">
                <div class="card-header bg-primary text-white text-center">
                    <h3 class="mb-0">Scholarship Details</h3>
                </div>
                <div class="card-body">
                    <select name="categoryid" id="categoryid" class="form-control mb-3">
                        <option value="">Select Category</option>
                        {% for c in category %}
                        <option value="{{c.categoryid}}">{{c.categoryname}}</option>
                        {% endfor %}
                    </select>
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center align-middle">
                            <thead class="thead-dark">
                                <tr>
                                    <th>#</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Eligibility</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Link</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="scholarship"></tbody>
                        </table>
                    </div>
                    <div class="text-center mt-3">
                        <a href="{% url 'scholarship' %}" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Scholarship
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

{% include "Admin/Footer.html" %}
